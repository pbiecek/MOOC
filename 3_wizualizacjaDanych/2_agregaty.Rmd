---
title: "Wykresy, które podsumowują dane"
author: "poskRamiacze danych"
date: "sezon 3 / odcinek 2 <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "poskRamiacze danych / wizualizacja / agregaty danych"

---
# O czym jest ten odcinek?

Gdy dane są duże i zawierają wiele obserwacji niesposób przedstawiać każdy punkt osobno. Może ich być zbyt wiele przez co wykres zamieni się w wielką plątaninę punktów i krzywych. W takim przypadku często lepszym rozwiązaniu jest przedstawienie podsumowania danych.

W tym odcinku dowiemy się

- Jak tworzyć wykresy trendu, przedstawiające wygładzone średnie?
- Jak tworzyć wykresy ramka wąsy / pudełkowe, przedstawiające pięć liczb Tukeya?
- Jak tworzyć histogram, przedstawiający rozkład wartości?
- Jak tworzyć wykresy słupkowe, przedstawiające liczebności obserwacji?

W tym odcinku będziemy pracować ze zbiorem danych `auta2012`.

---

# Geometria `geom_smooth()` - wykresy trendu 

Gdy chcemy przedstawić zależność, pomiędzy parą zmiennych, często wykorzystywaną jest geometria punktowa `geom_point()`. Jednak, gdy punktów jest wiele, taka prezentacja może być  mało czytelna. W takich przypadkach warto rozważyć geometrię `geom_smooth()` prezentującą wygładzoną lokalną średnią.

Przedstawimy tę geometrię na przykładzie ceny i roku produkcji samochodu, a dokładniej modelu Volkswagen Passat.

```{r, fig.height=4, fig.width=5}
passaty <- auta2012 %>%
              filter(Model = 'Volkswagen', Marka = 'Passat')

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_point()

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_smooth()

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_smooth(se=FALSE)

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_point() + geom_smooth(se=FALSE)

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_point() + geom_smooth(se=FALSE, size=5)

ggplot(passaty, aes(x = Cena.w.PLN, y=Rok.produkcji)) + 
  geom_point() + 
  geom_smooth(se=FALSE, size=5) +
  geom_smooth(method="lm", se=FALSE, size=5, color="red")

```

---

# Geometria `geom_boxplot()` - wykresy ramka - wąsy

Wybierzmy pięcioletnie modele Volkswagena i porównajmy marki

```{r, fig.height=4, fig.width=5}

volkswageny <- auta2012 %>%
              filter(Marka = 'Volkswagen', Rok.produkcji=2007)

ggplot(volkswageny, aes(x=Model, y = Cena.w.PLN)) + 
  geom_point()

ggplot(volkswageny, aes(x=Model, y = Cena.w.PLN)) + 
  geom_boxplot()

ggplot(volkswageny, aes(x=Model, y = Cena.w.PLN)) + 
  geom_boxplot(fill="black")

ggplot(volkswageny, aes(x=Model, y = Cena.w.PLN, fill=Model)) + 
  geom_boxplot()

```

---

# Geometria `geom_hist()` - histogram

```{r, fig.height=4, fig.width=5}

```

---

# Geometria `geom_bar()` - wykresy słupkowe

```{r, fig.height=4, fig.width=5}

```


---

# Gdzie szukać dalej

- Więcej informacji o tym jak budować wykresy w pakiecie ggplot2 znaleźć można w rozdziale 4 książki *,,Przewodnik po pakiecie R''*. Więcej informacji o tej książce http://www.biecek.pl/R/

- Wiele przydatnych wskazówek można również znaleźć w internetowej książce *,,Cookbook for R''* http://www.cookbook-r.com/Graphs/

- Bardzo rozbudowana dokumentacja dla pakietu ggplot2 dostępna jest na stronie *,,ggplot2''* http://docs.ggplot2.org/current/index.html







```{r, echo=FALSE}
library(SmarterPoland)
# diagnoza <- osoby[!is.na(osoby$WAGA_2013_OSOBY), c("IMIE_2011",
#           "WAGA_2013_OSOBY",
#           "lata_nauki_2013",
#           "WIEK2013",
#           "PLEC",
#           "województwo",
#           "EDUK4_2013",
#           "status9_2013",
#           "GP3",
#           "GP29",
#           "GP54_01",
#           "GP54_02",
#           "GP54_03",
#           "GP54_04",
#           "GP54_05",
#           "GP54_06",
#           "GP54_07",
#           "GP54_08",
#           "GP54_09",
#           "GP54_10",
#           "GP54_11",
#           "GP54_12",
#           "GP54_13",
#           "GP54_14",
#           "GP54_15",
#           "GP54_16",
#           "GP54_17",
#           "GP54_18",
#           "GP54_19",
#           "GP54_20",
#           "GP54_21",
#           "GP54_22",
#           "GP60","GP61",
#           "GP64",
#           "GP113")]
#save(diagnoza, file="diagnoza.rda")
#diagnozaDict <- osobyDict[colnames(diagnoza),]
#save(diagnozaDict, file="diagnozaDict.rda")

ggplot(diagnoza, aes(x=WIEK2013, fill=GP29)) +
  geom_bar(position="fill")

ggplot(diagnoza[!is.na(diagnoza$GP54_13),], aes(x=WIEK2013, fill=GP54_13)) +
  geom_bar(position="fill") + facet_wrap(~PLEC)

ggplot(diagnoza[!is.na(diagnoza$GP54_01),], aes(x=WIEK2013, fill=GP54_13)) +
  geom_bar(position="fill") + facet_wrap(~PLEC)

ggplot(diagnoza[!is.na(diagnoza$GP54_01),], aes(x=WIEK2013, fill=PLEC)) +
  geom_bar(position="fill") + facet_wrap(~GP54_13)

ggplot(diagnoza[!is.na(diagnoza$GP54_13),], aes(x=WIEK2013, fill=GP54_13)) +
  geom_bar(position="fill")

ggplot(diagnoza, aes(x=WIEK2013, y=GP113)) +
  geom_point() + geom_smooth(se=F, size=3)

ggplot(diagnoza, aes(x=WIEK2013, y=GP64)) +
  geom_smooth(se=F, size=3)

ggplot(diagnoza, aes(x=GP113, y=GP64)) +
   geom_smooth(se=F, size=3)

quantile(diagnoza$GP64, seq(0,1,0.01), na.rm = TRUE)

```

