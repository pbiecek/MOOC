---
title: "Dates"
author: "data busteRs"
date: "Season 1 / Episode 15 <br><br><br><br>Press `A` to see the plain text instead of the slides. <br> Press `T` to display the table of contents."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "data busteRs / processing / dates"

---

# What Is This Episode About

When analysing the data, we encounter different types of variables. The data and time related variables appear to be quite common.

In this Episode, we will learn:

- How to create the objects that describe dates and time in the R.
- What basic operations can be performed on the dates and time.
- How to sum up/describe the dates.

To illustrate these issues, we will use the ad hoc sets of data.

---

# Dates and Time

In the R program, there are three basic types of date or time describing variables.

+ The class `Date` is used to describe the dates with accuracy of a day. On the dates, you can perform such operations as subtraction of two dates, addition of a number to a day, etc.

+ The class `POSIXct` is used to describe the dates with accuracy of a second. Time is remembered as a number of the seconds from the defined beginning. The suffix `ct` means *calendar time*.

+ The class `POSIXlt` is used to describe time in a format of a value list. The suffix `lt` means *local time*. 

---

# Dates

The construction of the class `Date` is the function `as.Date()`.

It adopts the vector of character strings, which describe the dates, to be the first argument. The second, optional argument defines the date format. By default, the date format is year-month-day. 

```{r}
as.Date("2015-02-22")
as.Date("02/22/2015", format = "%m/%d/%Y")
as.Date("February 2, 2015", format = "%B %d, %Y")
```

To get assistance on the date format designations, please open the help file using the instruction `?strptime`.

The objects of the class Date can also be created on the basis of the integers or the POSIXct class objects, in both cases using the function `as.Date()`.

---

# Calendar Time

The constructor of the class `POSIXct` is the function `as.POSIXct()`.

It adopts the vector of character strings, which describe the moments, to be the first argument. The second, optional argument defines the date format. By default, the date format is year-month-day hour:minute:second. 

To get assistance on the date format designations, please open the help file using the instruction `?strptime`.

```{r}
(czas1 <- as.POSIXct("2015-02-13 12:56:26"))
(czas2 <- as.POSIXct("14022015 12:56:26", format = "%d%m%Y %H:%M:%S"))
```

You can perform such operations on time as subtraction or addition to one time of a specified interval (days by default).

```{r}
# r贸偶nica czas贸w
czas2 - czas1
czas1
czas1 + 30
```

The function `Sys.time()` returns the current time in the format `POSIXct`as the result.

```{r}
Sys.time()
Sys.time() - czas1
```

---

# Local Time

The constructor of the class `POSIXlt` is the function `as.POSIXlt()`.

It adopts the vector of character strings, which describe the moments, to be the first argument. The second, optional argument defines the date format.
The format description is the same as in the case of the class `POSIXct`.

```{r}
(czas1 <- as.POSIXlt("2015-02-13 12:56:26"))
(czas2 <- as.POSIXlt("14022015 12:56:26", format = "%d%m%Y %H:%M:%S"))
```

Objects of the class `POSIXlt` are lists, it is possible to refer to their elements by using the name.

```{r}
czas1$sec
czas1$min
czas1$zone
```


Many functions can be applied interchangeably with the objects of the class `POSIXlt` and `POSIXct`.

```{r}
# r贸偶nica czas贸w
czas2 - czas1
czas1 + 30
```

---

# Lubridate Package

In the basic R program, the operations on the dates and time are not always simple. We mean, the simple operations are simple, but the complex ones are not necessarily easy.

The package `lubridate` contains the set of the functions that facilitate handling the dates.

One of such functions is the function `now()`, which returns an object that describes the present moment.

```{r}
library(lubridate)
now()
today()
```

The function names used to convert the strings of characters into time were simplified. A function name becomes a format description.

```{r}
ymd_hms("2015-02-14 23:59:59")
(czas3 <- mdy_hm("02/14/15 08:32"))
```

---

# Lubridate Package

You can extract such information as a day of week, a day of month, etc. from the dates. Using the function `wday()` you can read a day of week, similarly the functions `day()`, `month()` and `year()` describe the date components.

```{r}
wday(czas3, label = TRUE)
# tydzie w roku, dzie miesica, miesic i rok
week(czas1)
day(czas1)
month(czas1)
year(czas1)
```

You can perform the convenient operations using the function `days()`, `months()`, `years()`, `minutes()` and `seconds()`on time.

```{r}
czas3 + hours(4)
czas3 + days(2) + months(4) + years(1)
```

---

# Exercises

+ Applying the proper date format, convert the string of characters `01-15-2015 10:20:59` to the object of the class `POSIXct`.

+ Calculate the number of the days between 1 September 1939 and 8 May 1945.

+ Check what a day of week will be in 100 days starting from today.


---

# More Information

You can find the useful tips how to work with time and dates in the article titled  *Handling date-times in R* by Cole Beck at
http://biostat.mc.vanderbilt.edu/wiki/pub/Main/ColeBeck/datestimes.pdf.

The detailed description of the package `lubridate` can be found in the JSSs article at http://www.jstatsoft.org/v40/i03/paper

A lot of interesting information on handling the dates and time is available at
http://en.wikibooks.org/wiki/R_Programming/Times_and_Dates

