---
title: "Instrukcje warunkowe"
author: "pogRomcy danych"
date: "sezon 1 / odcinek 9<br><br> Wszelkie prawa zastrzeżone.<br> Wykorzystanie możliwe wyłącznie za zgodą autora.  <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "pogRomcy danych / programowanie / instrukcje warunkowe"

---

# O czym jest ten odcinek

Mnogość dostępnych algorytmów do analizy danych stawia nas często przed koniecznością wyboru. Czy użyć metody A, czy metody B? Każda z nich może być lepsza w innej sytuacji. Najlepszym rozwiązaniem jest często warunkowe użycie jednej lub drugiej metody w zależności od tego jak wyglądają nasze dane.

Do warunkowego wykonania jednej lub drugiej grupy instrukcji służą instrukcje warunkowe.

W tym odcinku nauczymy się:

- jak korzystać z instrukcji warunkowych,
- jak korzystać z instrukcji warunkowych w pętli.

Do ilustracji wykorzystamy zbiór danych `koty_ptaki` dostępny w pakiecie `SmarterPoland`.

```{r, message=FALSE, warning=FALSE}
library(SmarterPoland)
head(koty_ptaki, 3)
```

---

# Instrukcje warunkowe

Przygotowując program często jesteśmy w sytuacji, w której dalsza akcja zależy od pewnej wartości, dla nas nieznanej lub potencjalnie zmieniającej się.

Przykładowo, jeżeli losujemy liczbę losową z przedziału 0-1 i w zależności od tego jaka liczba została wylosowana chcemy napisać `Orzeł` lub `Reszka`, w czasie pisania kodu nie wiemy jaka wartość się wylosuje.

Używając instrukcji warunkowych możemy opisać alternatywne scenariusze, które będą wykonane w zależności od określonego warunku.

Poniższy kod wypisze na ekranie napis `Orzeł`, jeżeli wylosuje się liczba mniejsza od 0.5 oraz napis `Reszka`, jeżeli wylosuje się liczba większa lub równa 0.5.

```{r}
liczbaLosowa <- runif(n = 1)

if (liczbaLosowa < 0.5) {
  cat("Orzeł")
} else {
  cat("Reszka")
}
```

---

# Instrukcje warunkowe

Przygotowując algorytm przetwarzania danych często potrzebujemy rozważyć różne możliwe sytuacje.
Aby zapisać warianty wykonywania w zależności od stanu określonych zmiennych, można wykorzystać instrukcje warunkowe.

Najczęściej wykorzystywaną instrukcją warunkową jest `if else`, która w języku R występuje w trzech odmianach.

Jeżeli `warunek` występujący po bloku `if` jest prawdziwy, wykonana będzie instrukcja `wyrażenie1`, w przeciwnym przypadku `wyrażenie2` (o ile jest wskazane).

Trzecia wymieniona poniżej odmiana to instrukcja `ifelse()`, która może operować nie tylko na jednej wartości logicznej TRUE/FALSE ale na całym wektorze wartości logicznych.

```{r, eval=FALSE}
if (warunek) 
  wyrażenie1

if (warunek) 
  wyrażenie1 
else 
  wyrażenie2

ifelse (warunek_dla_wektora, wyrażenie1, wyrażenie2) 
```

Jeżeli wyrażenie obejmuje więcej niż jedną instrukcje, należy je otoczyć blokiem `{}`.

Nawet gdy wyrażenie jest jedną instrukcją, to dodawanie nawiasów klamrowych `{}` jest popularną praktyką, powoduje bowiem, że kod jest czytelniejszy. 

```{r, eval=FALSE}
if (warunek) {
  wyrażenie1
}

if (warunek) {
  wyrażenie1
} else {
  wyrażenie2 
}
```

---

# Instrukcje warunkowe

Na przykładzie pierwszego wiersza z tabeli danych `koty_ptaki` zademonstrujemy jak działają kolejne odmiany instrukcji warunkowej. Kolumnę `gatunek` musimy zamienić na kolumnę napisów, inaczej nazwy gatunków będą się źle wyświetlały. Będziemy pracować na pierwszym wierszu, ale indeks tego wiersza zapiszemy w zmiennej `i`. Dzięki temu, łatwiej nam będzie później wykorzystać ten kod w pętli.

```{r, message=FALSE, warning=FALSE}
koty_ptaki$gatunek <- as.character(koty_ptaki$gatunek)
i <- 9
koty_ptaki[i,]
```

Jeżeli użyjemy wyłącznie bloku `if`, to w sytuacji gdy `warunek` jest fałszywy nic się wyświetli na ekranie.

```{r, message=FALSE, warning=FALSE}
if (koty_ptaki[i,"druzyna"] == "Kot") {
  cat(koty_ptaki[i,"gatunek"], "to duży kot.")
}
```

Jeżeli użyjemy instrukcji `if-else`, to gdy `warunek` okaże się być fałszywy wyświetli się wynik części `else`.

```{r, message=FALSE, warning=FALSE}
if (koty_ptaki[i,"druzyna"] == "Kot") {
  cat(koty_ptaki[i,"gatunek"], "to duży kot.")
} else {
  cat(koty_ptaki[i,"gatunek"], "to ptak.")
}
```


---

# Instrukcje warunkowe

Jeżeli pracujemy na wektorach, wygodnym rozwiązaniem jest skorzystanie z instrukcji wektorowej `ifelse()`.

Jej pierwszym argumentem może być wektor. Przykładowo instrukcja `koty_ptaki[,"druzyna"] == "Kot"` tworzy wektor wartości logicznych.

```{r, message=FALSE, warning=FALSE}
koty_ptaki[,"druzyna"] == "Kot"
```

Wykorzystamy ją w instrukcji `ifelse()` i jako wynik otrzymamy wektor napisów o wartościach `"Kolejny wielki kot"` tam gdzie występowała wartość TRUE i wartościach `"Kolejny szybki ptak"` tam gdzie występowała wartość FALSE.

```{r, message=FALSE, warning=FALSE}
ifelse(koty_ptaki[,"druzyna"] == "Kot",
  "Kolejny wielki kot",
  "Kolejny szybki ptak")
```

---

# Pętle i instrukcje warunkowe

Instrukcje warunkowe są często wykorzystywane wewnątrz pętli. W sytuacji gdy chcemy powtórzyć pewną operację kilkukrotnie, ale przebieg danej operacji może mieć kilka wariantów / scenariuszy.

Zilustrujemy tę sytuację w poniższym przykładzie.

W zależności od tego czy określony gatunek jest kotem czy ptakiem wyświetlimy inną formułę.


```{r, message=FALSE, warning=FALSE}
# pętla wykona się dla każdego wiersza
for (i in 1:nrow(koty_ptaki)) {
  # wewnątrz pętli wykonanie zależy od warunku i instrukcji if
  if (koty_ptaki[i,"druzyna"] == "Kot") {
    cat(koty_ptaki[i,"gatunek"], "to wielki i szybki kot.\n")
  } else {
    cat(koty_ptaki[i,"gatunek"], "to ptak.\n")
  }
}
```

---

# Pętle i instrukcje warunkowe

Innym częstym zastosowaniem instrukcji warunkowych jest zmiana wartości zmiennej na inną wartość w zależności od tego jaki wystąpił warunek.

W przykładzie poniżej, w pętli wykonujemy instrukcję warunkową, która w jednej sytuacji zmienia wartość zmiennej `liczbaKotów`, a w innej zmiennej `liczbaPtaków`.

```{r, message=FALSE, warning=FALSE}
# inicjujemy zmienne
liczbaKotow  <- 0
liczbaPtakow <- 0
# w pętli będziemy zmieniać wartość zmiennych w zależności od tego 
# czy kolejny wiersz opisuje koty czy ptaki
for (i in 1:nrow(koty_ptaki)) {
  if (koty_ptaki[i,"druzyna"] == "Kot") {
    liczbaKotow  <- liczbaKotow + 1
  } else {
    liczbaPtakow <- liczbaPtakow + 1
  }
}
# zliczamy ile było kotów i ptaków
liczbaKotow 
liczbaPtakow
```

---

# Podsumowanie instrukcji R

W tym odcinku omawialiśmy instrukcje warunkowe.

Poniżej znajduje się zestawienie wszystkich wykorzystanych w tym odcinku instrukcji.

```{r, eval=FALSE}
# Instrukcja warunkowa, której wykonanie zależy od wylosowanej wartości
liczbaLosowa <- runif(n = 1)
if (liczbaLosowa < 0.5) {
  cat("Orzeł")
} else {
  cat("Reszka")
}

# Instrukcja warunkowa z samym blokiem if
i <- 9
if (koty_ptaki[i,"druzyna"] == "Kot") {
  cat(koty_ptaki[i,"gatunek"], "to duży kot.")
}

# Instrukcja warunkowa z blokiem if-else
if (koty_ptaki[i,"druzyna"] == "Kot") {
  cat(koty_ptaki[i,"gatunek"], "to duży kot.")
} else {
  cat(koty_ptaki[i,"gatunek"], "to ptak.")
}

# Warunki logiczne można wykonywać na wektorach wartości
koty_ptaki[,"druzyna"] == "Kot"

# Instrukcja warunkowa ifelse() działa też na wektora
ifelse(koty_ptaki[,"druzyna"] == "Kot",
  "Kolejny wielki kot",
  "Kolejny szybki ptak")
```

---

# Podsumowanie instrukcji R

W tym odcinku omawialiśmy instrukcje warunkowe.

Poniżej znajduje się zestawienie wszystkich wykorzystanych w tym odcinku instrukcji.

```{r, eval=FALSE}
# W pętlach, gdy dla różnych wierszy należy wykonać inne operacje wygodnie jest korzystać 
# z instrukcji warunkowych
for (i in 1:nrow(koty_ptaki)) {
  # wewnątrz pętli wykonanie zależy od warunku i instrukcji if
  if (koty_ptaki[i,"druzyna"] == "Kot") {
    cat(koty_ptaki[i,"gatunek"], "to wielki i szybki kot.\n")
  } else {
    cat(koty_ptaki[i,"gatunek"], "to ptak.\n")
  }
}

# W instrukcjach warunkowych nie tylko możemy wyświetlać różne napisy,
#    ale również zmieniać wartości zmiennych.
# W poniższym przykładzie w zależności od tego jaki wiersz jest odczytywany 
#    inaczej zmieniamy wartości liczników
liczbaKotow  <- 0
liczbaPtakow <- 0
for (i in 1:nrow(koty_ptaki)) {
  if (koty_ptaki[i,"druzyna"] == "Kot") {
    liczbaKotow  <- liczbaKotow + 1
  } else {
    liczbaPtakow <- liczbaPtakow + 1
  }
}
# zliczamy ile było kotów i ptaków
liczbaKotow 
liczbaPtakow
```

---

# Zadania

* Napisz instrukcję warunkową, która dla zwierząt lżejszych niż 1kg wypisze `lekkie`, a dla cięższych niż 1 kg `ciężkie`.

* Napisz instrukcję warunkową, która dla zwierząt lżejszych niż 1kg wypisze `lekkie`, cięższych niż 100kg wypisze `ciężkie` a w przedziale 1-100kg wypisze `średnie`. Taki efekt można uzyskać stosując dwie instrukcje `if()` lub korzystając z funkcji `switch()`.

* Napisz pętlę i instrukcję warunkową sumującą łączne masy wszystkich ptaków i kotów osobno.

Przykładowe odpowiedzi znajdują się na stronie https://rawgit.com/pbiecek/MOOC/master/0_dane/9_zadania.html
