---
title: "Czyszczenie i wprowadzenie do obróbki danych"
author: "pogRomcy danych"
date: "sezon 1 / odcinek 16 <br><br> Wszelkie prawa zastrzeżone.<br> Wykorzystanie możliwe wyłącznie za zgodą autora.  <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "pogRomcy danych / przetwarzanie / czyszczenie i obróbka"

---

# O czym jest ten odcinek

Praca z danymi to w dużej części czyszczenie i zmiana struktury. Zarówno dane zbierane przez ludzi jak i przez automatyczne czujniki mają tendencje do zawierania braków, obserwacji odstających lub zwykłych błędów. Aby sensownie analizować dane, musimy przekształcić je do postaci w której wyniki anliz będą wiarygodne.

Czyszceznie to bardzo istotna faza. Bez względu bowiem jak zaawansowana i dobrze dobrana jest nasza technika analiza danych, jeżeli na wejściu będą śmieciowe dane to na wyjściu będą śmieciowe wyniki. *Garbage in garbage out*

W tym odcinku nauczymy się

- Jak edytować zbiory danych by doprawadzić je do spójnej postaci.
- Jak zastępować jedne wartości przez inne
- Jak identyfikować wartości odstające / zbędne.

Mając dane wyczyszczone, możemy przejść do kolejnych etatów, czyli wstępnej obróbki, analizy i wizualizacji.

---


# Tworzenie danych przez funkcję data.frame()

```{r}
D <- data.frame(
      imie = c("Maja","Anna","Zosia","Joanna"),
      więk = c("40","12,5","25","16.6"),
      oczy = factor(c("niebieskie", "jasno-niebieskie", "ciemne", "niebieskie"))
      )
D <- data.frame(sapply(D,as.character), stringsAsFactors=FALSE)
```

# Edycja w całej kolumnie


# Zamiana nazwy kolumny


# Zamiana przecinka na kropkę


# Usuwanie lub zastępowanie brakujących danych


# Normalizacja kolumny lub wiersza


# Zmiana nazw czynników w zmienej jakościowej / redukcja liczby poziomów

Przykładowe dane:
```{r}
# zmiana znaku jednego na inny wszedzie, np ó na o
# zmiana przecinka na kropkę i konwersja na liczby
# zmiana nazw lub kolejności czynników w zmiennej jakościowej
# zmiana nazwy kolumny
# zmiana jednej wartosci w macierzy [np rzad wielkosci inne]

D <- data.frame(
  imie= c("Maja","Anna","Zosia","Joanna"),
  gęstość= c("0.4","0,2","0,05","0,35")
  )
D <- data.frame(sapply(D,as.character), stringsAsFactors=FALSE)
```

Po wczytaniu danych otrzymamy tabelę:
```{r}
D
```

Klasy poszczególnych zmiennych w tabeli D:
```{r}
sapply(D,class)
```

Błędy w danych które chcemy naprawić:

1. Zamień nazwę kolumny: gęstość na częstość,
2. Zamień wpisy "Zosia" na "Zofia",
2. Zamień przecinek na kropkę dziesiętną.


### Naprawa nazwy kolumny - gęstość

Numer kolumny o błędnej nazwie "gęstość":
```{r}
nr.kol <- which(colnames(D)=="gęstość")
nr.kol
```

Zamiana nazwy kolumny:
```{r}
names(D)[nr.kol] <- paste("częstość")
D
```

### Naprawa błędnych wpisów - Zosia

```{r}
D$imie[D$imie=="Zosia"] <- "Zofia"
D
```

### Naprawa błędnych wpisów - liczb

Ponieważ takich pomyłek/liczb może być więcej można zastosować funkcję: sub:
```{r}
D$częstość <- sub(",", ".", D$częstość, fixed = TRUE)
D
sapply(D,class)
```

```{r}
D$imie <- as.factor(D$imie)
D$częstość <- as.numeric(D$częstość)
sapply(D,class)
D
```

Do rozwiązywania powyższych problemów bardzo pomocne mogą okazać się funkcje: base::replace oraz car::recode.



Sciagawka z zabawy danymi w dplyr

http://www.rstudio.com/wp-content/uploads/2015/01/data-wrangling-cheatsheet1.pdf

wiecej sciagawek

http://www.rstudio.com/resources/cheatsheets/


