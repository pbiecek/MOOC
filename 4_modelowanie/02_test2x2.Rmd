---
title: "Testy 2x2"
author: "pogRomcy danych"
date: "sezon 3 / odcinek 2<br><br> Wszelkie prawa zastrzeżone.<br> Wykorzystanie możliwe wyłącznie za zgodą autora.  <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "pogRomcy danych / pierwsze kroki / testy 2x2"
---

# O czym jest ten odcinek

Jak badać czy dwie zmienne są zależne?

Co oznacza zależność?

W tym odcinku rozważymy najprostszą zależność dla pary zmiennych - zależność pomiędzy parą zmiennych binarnych.

W tym odcinku nauczymy się jak:

- jak budować i jak czytac tablice kontyngencji dla pary zmiennych
- jak przedstawiać graficznie tabelę kontyngencji
- jak statystycznie testować zależność pomiedzy parą zmiennych.

Do ilustracji tych zagadnień wykorzystamy dwa zbiory danych. Pierwszy, to dane z Diagnozy Społecznej, dostępne w tabeli `diagnoza` a drugi o nowotworze piersi, dostępne w tabeli `TCGA_BRCA`, oba dostępne w pakiecie `PogromcyDanych`.

---

# Jak opisać zależnośc dwóch zmiennych binarnych


# Wczytanie danych

Dane od których rozpoczniemy przykłady to `diagnoza` z pakietu `PogromcyDanych`. Aby te dane wczytać, wystarczy włączyć ten pakiet - instrukcja jak to zrobić znajduje się w odcinku 2 pierwszego sezonu.

W zbiorze danych `diagnoza` dostępnych jest kilkadziesiąt kolumn, opisujących odpowiedzi na różne interesujące pytania. W tym odcinku przyjrzymy się tylko kilku  wybranym kolumnom, opisującym imię, wiek, płeć, ukończoną edukację oraz odpowiedź na pytanie ,,Co jest wedlug Pana wazniejsze w zyciu?'' (zmienna w kolumnie `gp29`) z możliwymi odpowiedziami *Poczucie sensu* i *Przyjemności*.

```{r, warning=FALSE, message=FALSE}
library(PogromcyDanych)
diagnoza[1:6, c("imie_2011", "wiek2013", "plec", "eduk4_2013", "gp29")]
```

# Jak wygląda tabela kontyngencji


```{r}
table(diagnoza$plec, diagnoza$gp29)

```






```{r}
prop.table(table(diagnoza$plec, diagnoza$gp29), 1)
```

# Co to znaczy: cecha jakościowa

# Co to znaczy: cecha jakościowa

# Co to znaczy: cecha jakościowa

# Co to znaczy: cecha jakościowa

# Co to znaczy: cecha jakościowa



```{r}
library(PogromcyDanych)
library(dplyr)

plecCoWazne <- diagnoza %>% select(plec, gp29, waga_2013_osoby)
head(plecCoWazne)
```



---

# O czym jest ten odcinek

```{r, eval=FALSE}
table(plecCoWazne$plec, plecCoWazne$gp29)

prop.table(table(plecCoWazne$plec, plecCoWazne$gp29), 1)

fisher.test(table(plecCoWazne$plec, plecCoWazne$gp29))


prop.table(table(diagnoza$gp54_11, cut(diagnoza$wiek2013, c(0, 25, 40, 60, 110))), 2)

addmargins(table(ojcowiedziecmi = diagnoza$gp54_22, dziecirodzicami = diagnoza$gp54_11))

```

# tez 2xp

```{r}

prop.table(table(diagnoza$gp29, cut(diagnoza$wiek2013, c(0, 25, 40, 60, 110))), 2)

prop.table(table(diagnoza$gp29, diagnoza$eduk4_2013), 2)

prop.table(table(diagnoza$eduk4_2013, cut(diagnoza$wiek2013, c(0, 25, 40, 60, 110)), diagnoza$gp29), 1:2)

```

---

Test 2x2 McNemara


```{r, eval=FALSE}
# brak przerzutow dobrze rokuje
table(TCGA_BRCA$new.tumor,
      TCGA_BRCA$vital.status)

fisher.test(table(TCGA_BRCA$new.tumor,
      TCGA_BRCA$vital.status))

fisher.test(table(TCGA_BRCA$new.tumor,
      TCGA_BRCA$TP53 == "Wild type"))


head(TCGA_BRCA)

table(TCGA_BRCA$TP53,
      TCGA_BRCA$vital.status)

chisq.test(table(TCGA_BRCA$TP53,
      TCGA_BRCA$vital.status))

pairwise.prop.test(TCGA_BRCA$new.tumor, TCGA_BRCA$TP53)

```


