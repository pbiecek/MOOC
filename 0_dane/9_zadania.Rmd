---
title: "Zadania i odpowiedzi"
author: "pogRomcy danych"
date: "sezon 0 / odcinek 0 <br><br> Wszelkie prawa zastrzeżone.<br> Wykorzystanie możliwe wyłącznie za zgodą autora.  <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "pogRomcy danych / eksploracja danych / zadania i odpowiedzi"
---

# Zadanie, sezon 1, odcinek 5

W kolejnych odcinkach będziemy korzystać ze zbioru danych o cenach aut. 
Ten zbiór danych można pobrać ze strony kursu w różnych formatach pod następującymi linkami:

- dane Excelowe, http://biecek.pl/MOOC/dane/auta2012mini.xls

- dane tekstowe, http://biecek.pl/MOOC/dane/auta2012mini.csv

- dane binarne, http://biecek.pl/MOOC/dane/auta2012mini.rda

- w pakiecie `PogromcyDanych` w zmiennej `auta2012`.

*Zadanie:* 

Wczytać do programu R dane wykorzystując każdy z tych formatów.

*Uwaga!* Wskazane pliki mają do 3.5 MB wielkości. Ich pobieranie może trochę potrwać jeżeli połączenie internetowe nie jest dobre lub wiele osób jednocześnie z niego korzysta.

---

# Odpowiedzi, sezon 1, odcinek 5

```{r, eval=FALSE}
# plik tekstowy
auta2012 <- read.table(file = "http://biecek.pl/MOOC/dane/auta2012mini.csv", 
          sep=";", dec=",", header=TRUE)

# plik Excela
library(gdata)
auta2012 <- read.xls("http://biecek.pl/MOOC/dane/auta2012mini.xls", sheet=1)

# plik rda
# nie trzeba przypisywać do zmiennej
load(url("http://biecek.pl/MOOC/dane/auta2012mini.rda"))

```

---

# Zadanie, sezon 1, odcinek 6

- Zapisz zbiór danych `koty_ptaki` do pliku tekstowego, w którym dane są rozdzielane przecinkiem, a separatorem dziesiętnym jest `.` (kropka).
- Zapisz zbiór danych `koty_ptaki` do formatu pliku Excela. Sprawdź czy dane poprawnie się zapisały.
- Zapisz zbiór danych `koty_ptaki` do pliku binarnego. Odczytaj go następnie funkcją `load()` i sprawdź czy dane poprawnie zostały zapisane.

---

# Odpowiedzi, sezon 1, odcinek 6

```{r, eval=FALSE}
# plik tekstowy
write.table(koty_ptaki, file = "dane_o_kotach.csv", sep=",", dec=".")

# plik Excela
library(xlsx)
write.xls(koty_ptaki, file = "koty_ptaki.xlsx", sheetName="Zakladka 1")

# dane binarne
save(koty_ptaki, file="koty_ptaki.rda")
load("koty_ptaki.rda")
```

---

# Zadania, sezon 1, odcinek 7

- Zbuduj sekwencję dziesięciu kolejnych małych liter alfabetu łacińskiego.

- Zbuduj sekwencję dziesięciu kolejnych liczb nieparzystych zaczynając od `3`.

- Z wektora `LETTERS` wybierz litery na pozycjach 5, 10, 15, 20 i 25.

- Wypisz wartości wektora `LETTERS` od końca.

---

# Odpowiedzi, sezon 1, odcinek 7

```{r}
# kolejne litery
c('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j')
letters[1:10]

# nieparzyste od 3
seq(3, 21, 2)

# wybrane z LETTERS
LETTERS[c(5, 10, 15, 20, 25)]

# od końca wektor LETTERS
LETTERS[26:1]
```

---

# Zadania, sezon 1, odcinek 7

- Wybierz z ramki danych `koty_ptaki` wszystkie wiersze poza ,,Sokołami'' (wiersz 11 i 12)

- Wybierz z ramki danych `koty_ptaki` tylko koty (pierwsze siedem wierszy)

- Wybierz z ramki danych `koty_ptaki` tylko kolumnę z wagą i prędkością

- Wybierz z ramki danych `koty_ptaki` wszystkie kolumny poza ostatnią

- Wybierz z ramki wiersze dla których waga jest mniejsza niż 100 oraz cztery pierwsze kolumny.

---

# Odpowiedzi, sezon 1, odcinek 7

```{r, eval=FALSE}
# poza sokołami
koty_ptaki[- (11:12), ]
koty_ptaki[c(1:10, 13), ]

# tylko koty
koty_ptaki[1:7, ]
koty_ptaki[koty_ptaki$druzyna == "Kot", ]

# tylko dwie kolumny
koty_ptaki[, c("waga", "predkosc")]
koty_ptaki[, c(2, 4)]

# poza ostatnią
koty_ptaki[, 1:6]
koty_ptaki[, -7]

# lekkie 
koty_ptaki[koty_ptaki$waga < 100, 1:4]
```

---

# Zadania, sezon 1, odcinek 8

* Napisz pętlę, która dla każdego wiersza z tabeli `koty_ptaki` wypisze żywotność określonego gatunku.
* Napisz pętlę, która przedstawi żywotność za pomocą wykresu, na którym każdy rok przedstawiony jest jako jeden `#`.
* Napisz pętlę, która narysuje wykres z żywotnością, ale z nazwami gatunku po lewej stronie. Co więcej, przed każdą nazwą gatunku należy dodać tyle znaków spacja, aby nazwy były wyrównane do prawej strony. Długość napisu, mierzoną w liczbie znaków można odczytać funkcją `nchar()`.

---

# Odpowiedzi, sezon 1, odcinek 8

```{r, eval=FALSE}
# Pętla z żywotnością
for (i in 1:nrow(koty_ptaki)) {
  cat("Osobniki gatunku:", koty_ptaki[i,"gatunek"], "żyją do", 
      koty_ptaki[i,"zywotnosc"], "lat\n")
}

# Żywotność za pomocą wykresu
for (i in 1:nrow(koty_ptaki)) {
  n_kropek <- koty_ptaki[i,"zywotnosc"] 
  for (j in 1:n_kropek)
    cat("#")
  cat(" ", koty_ptaki[i,"gatunek"], "\n")
}

# Nazwa gatunku po lewej stronie
for (i in 1:nrow(koty_ptaki)) {
  # uzupełniamy spacje
  n_spacji <- 15 - nchar(as.character(koty_ptaki[i,"gatunek"])) 
  for (j in 1:n_spacji)
    cat(" ")
  cat( koty_ptaki[i,"gatunek"], " ")
  # wykres rysuje żytowność za pomocą #
  n_kropek <- koty_ptaki[i,"zywotnosc"] 
  for (j in 1:n_kropek)
    cat("#")
  cat("\n")
}

```

---

# Zadania, sezon 1, odcinek 9

* Napisz instrukcję warunkową, która dla zwierząt lżejszych niż 1kg wypisze `lekkie`, a dla cięższych niż 1 kg `ciężkie`.
* Napisz instrukcję warunkową, która dla zwierząt lżejszych niż 1kg wypisze `lekkie`, cięższych niż 100kg wypisze `ciężkie` a w przedziale 1-100kg wypisze `średnie`. Taki efekt można uzyskać stosując dwie instrukcje `if()` lub korzystając z funkcji `switch()`.
* Napisz pętlę i instrukcję warunkową sumującą łączną masę wszystkich ptaków i osobno kotów.

---

# Odpowiedzi, sezon 1, odcinek 9

```{r, eval=FALSE}
# Lekkie / ciężkie
for (i in 1:nrow(koty_ptaki)) {
  if (koty_ptaki[i,"waga"] < 100) {
    cat(koty_ptaki[i,"gatunek"], "to lekkie zwierze.\n")
  } else {
    cat(koty_ptaki[i,"gatunek"], "to ciężkie zwierze.\n")
  }
}

# Lekkie / średnie / ciężkie
for (i in 1:nrow(koty_ptaki)) {
  if (koty_ptaki[i,"waga"] < 1) {
    cat(koty_ptaki[i,"gatunek"], "to lekkie zwierze.\n")
  } else {
    if (koty_ptaki[i,"waga"] < 100) {
      cat(koty_ptaki[i,"gatunek"], "to średnie zwierze.\n")
    } else {
      cat(koty_ptaki[i,"gatunek"], "to ciężkie zwierze.\n")
    }
  }
}

# Ważymy koty i ptaki
wagaKoty <- 0
wagaPtaki <- 0
for (i in 1:nrow(koty_ptaki)) {
  if (koty_ptaki[i,"druzyna"] == "Kot") {
    wagaKoty <- wagaKoty + koty_ptaki[i,"waga"]
  } else {
    wagaPtaki <- wagaPtaki + koty_ptaki[i,"waga"]
  }
}
```

---

# Zadania, sezon 1, odcinek 10

* Napisz funkcję, która otrzymuje argument liczbowy, a następnie wypisuje na ekran wartości od argumentu do jeden.
* Napisz funkcję, która przyjmuje argument liczbowy `n`, a następnie rysuje kwadrat o boku `n` wypełniony znakami `X`.
* Napisz funkcję, która przyjmuje argument liczbowy `n`, a następnie rysuje kwadrat o boku `n` ze znakami `X` na brzegu i pusty w środku.

---

# Odpowiedzi, sezon 1, odcinek 10

```{r, eval=FALSE}
# odliczanie do 1
odliczaj <- function(od = 10) {
  for (i in od:1) {
    cat(i, "\n")
  }
}
odliczaj(5)

# rysuj kwadrat
kwadrat <- function(n = 5, znak="X") {
  for (i in 1:n) {
    for (j in 1:n) {
      cat(znak)
    }
    cat("\n")
  }
}
kwadrat()

# rysuj pusty kwadrat
pustyKwadrat <- function(n = 5, znak="X") {
  for (i in 1:n) {
    for (j in 1:n) {
      if (i == 1 | j == 1 | i == n | j == n) {
        cat(znak)
      } else {
        cat (" ")
      }
    }
    cat("\n")
  }
}
pustyKwadrat()
```

---

# Zadania, sezon 1, odcinek 11

+ W zbiorze danych _auta2012_ aż 7 cech to cechy ilościowe. Wymień które.

+ Jedną z cech ilościowych jest _Rok.produkcji_. Wszystkie te oferty były złożone w roku 2012, jaki był medianowy/połówkowy wiek oferowanego auta?

+ Która cecha jest najmniej kompletna? Dla której cechy liczba brakujących wartości jest największa?

+ Jaka jest mediana/połówkowa wielkość silnika (`Pojemnosc.skokowa`)?

+ Przedstaw graficznie za pomocą wykresu pudełko-wąsy oraz histogramu rozkład cechy `Cena.w.PLN`.

+ Zwróć uwagę, że pojedyncze auta o bardzo wysokich cenach, powodują że wykres jest mało czytelny. Oczyść te dane, pozostawiają tylko auta o cenie poniżej 100 tys pln. Następnie przedstaw rozkład cen aut w segmencie aut do 100 tys pln.

+ Aut w jakiej cenie jest najwięcej wśród zebranych ogłoszeń? 

---

# Odpowiedzi, sezon 1, odcinek 11

```{r, eval=FALSE}
# Zmienne ilościowe
# `Cena`, `Cena.w.PLN`, `KM`, `kW`, `Pojemnosc.skokowa`, `Przebieg.w.km`, `Rok.produkcji`

# medianowy wiek to 2012 - mediana roku produkcji
2012 - median(auta2012$Rok.produkcji)

# Dla zmiennej `Przebieg.w.km`  jest 39 559 brakujących wartości. Ta zmienna jest najmniej kompletna.

# mediana koni mechanicznych
median(auta2012$KM, na.rm=TRUE)

# Usuńmy skrajne obserwacje i narysujmy rozkład ceny aut wykresem pudełkowym
auta2012wybrane <- auta2012[auta2012$Cena.w.PLN < 100000, ] 
boxplot(auta2012wybrane$Cena.w.PLN, horizontal = TRUE, range = 0)

# lub histogramem
hist(auta2012wybrane$Cena.w.PLN, 50, col="grey")

# najwięcej jest aut w okolicy 13000 (moda policzona po dyskretyzacji na 1000 przedziałów)
which.max(table(cut(auta2012wybrane$Cena.w.PLN, 1000)))
```


---

# Zadania, sezon 1, odcinek 12

+ Ile zmiennych w zbiorze danych `auta2012` to zmienne jakościowe? 

+ Zmienna `Liczba.drzwi` przyjmuje wartości `2/3` i `4/5`. Zachowuje się ona jako zmienna jakościowa. Jednak można uznać, że liczba drzwi to cecha ilościowa, ponieważ opisuje _ilość_ drzwi w samochodzie. Jak wyjaśnić tę dualność?

+ Cecha `Marka` opisuje markę samochodu. Sprawdź, która marka jest najpopularniejsza.

+ Cecha `Rodzaj.paliwa` opisuje rodzaj paliwa wykorzystywanego przez auto. Czy jest to benzyna, olej, gaz? Sprawdź jaki procent samochodów jest napędzana na benzynę.

+ Przedstaw graficznie tabelę liczebności dla zmiennej `Kraj.pochodzenia`. Wypróbuj wykres pionowy i poziomy. Aby obrócić kierunek etykiet na osiach dodaj do funkcji `barplot()` argument `las=1`.

+ W zbiorze danych `auta2012` podziel zmienne *Rok.produkcji* na przedziały 1900-1990, 1991-1995, 1996-2000, 2001-2005, 2006-2010, 2011-2012 a zmienną *Przebieg.w.km* na przedziały 0-1000, 1001-10 000, 10 001-100 000, 100 001 - 1000 000, 1000 000 - 10 000 000.

+ Wyznacz tabelę liczebności dla tych dwóch nowych zmienych.

+ Przedstaw tę tabelę graficznie.


---

# Odpowiedzi, sezon 1, odcinek 12

```{r, eval=FALSE}
names(which(sapply(auta2012, class) == "factor"))
##  [1] "Waluta"                       "Brutto.netto"                 "Marka"                       
##  [4] "Model"                        "Wersja"                       "Liczba.drzwi"                
##  [7] "Rodzaj.paliwa"                "Kolor"                        "Kraj.aktualnej.rejestracji"  
## [10] "Kraj.pochodzenia"             "Pojazd.uszkodzony"            "Skrzynia.biegow"             
## [13] "Status.pojazdu.sprowadzonego" "Wyposazenie.dodatkowe"      
```

Pewne zmienne, w zależności od kontekstu, mogą być traktowane i analizowane jak zmienne ilościowe lub zmienne jakościowe. Do nas należy wybór, która z tych opcji jest właściwsza.

Przykładowo, w typowych analizach takich danych nie ma sensu liczenia sumy lub średniej liczby drzwi. Co by bowiem by znaczyło, że auta wystawione do sprzedaży w styczniu miały średnio 3.8 drzwi? Dla zwykłego odbiory taka średnia nie ma sensu, niewiele bowiem mówi o zmiennej.
Nie ma specjalnie sensu stwierdzenie, że samochody marki Porsche mają średnio o 0.5 mniej drzwi niż samochody marki Toyota.

Ale już, gdybyśmy byli warsztatem malarskim, który ma pomalować te wszystkie drzwi, i w cenniku ma cenę od elementu, dla takiego warsztatu suma drzwi może mieć sens. W takim przypadku sensownie byłoby potraktowanie tej zmiennej jako zmiennej ilościowej i zsumowanie liczby drzwi.

```{r, eval=FALSE}
# Nazwa najpopularniejszej marki
names(which.max(table(auta2012$Marka)))

# Jaki procent aut jeździ na benzynie?
100*prop.table(table(auta2012$Rodzaj.paliwa))["benzyna"]

# Kraj pochodzenia aut
posortowanaTabela <- sort(table(auta2012$Kraj.pochodzenia))
barplot(posortowanaTabela, horiz = TRUE, las=1)

# Kategoryzacja
auta2012$Rok.produkcjiKat <- cut(auta2012$Rok.produkcji, c(1900, 1990.5, 1995.5, 2000.5, 2005.5, 2010.5, 2012.5))
auta2012$Przebieg.w.kmKat <- cut(auta2012$Przebieg.w.km, c(0-1000, 10000, 100000, 1000000, 10000000))

# Tablica liczebności
(przebiegRok <- xtabs(~Rok.produkcjiKat + Przebieg.w.kmKat, auta2012))

# wykres tablicy liczebności
mosaicplot(przebiegRok, las=2, color=TRUE)

```

---

# Zadania, sezon 1, odcinek 13

+ Sprawdź ile samochodów ma cenę ofertową poniżej 2 000 pln.

+ Sprawdź jaki procent samochodów ma silniki o pojemności ponad 1500 cm3.

+ Sprawdź ile samochodów zarejestrowanych w Polsce ma cenę ofertową poniżej 2 000 pln.

+ Sprawdź jaki procent samochodów ma silniki o pojemności ponad 1500 cm3 oraz jest napędzanych olejem napędowym.

---

# Odpowiedzi, sezon 1, odcinek 13

```{r, eval=FALSE}
# Liczba ofert poniżej 2 000
sum(auta2012$Cena.w.PLN < 2000, na.rm=TRUE)

# Procent aut o silnikach >= 1500cm3
100*mean(auta2012$Pojemnosc.skokowa >= 1500, na.rm=TRUE)

# Zarejestrowany w Polsce i poniżej 2k
taniZPolski <- auta2012$Cena.w.PLN < 2000 & auta2012$Kraj.aktualnej.rejestracji == "Polska"
sum(taniZPolski, na.rm=TRUE)

# Diesel z silnikiem >1500
duzyDiesel <- auta2012$Pojemnosc.skokowa > 1500 & auta2012$Rodzaj.paliwa == 'olej napedowy (diesel)'
mean(duzyDiesel, na.rm=TRUE)
```

---

# Zadania, sezon 1, odcinek 14


+ Wyznacz indeksy wierszy w zbiorze danych `koty_ptaki`, w których `gatunek` zawiera dużą lub małą literę `S`.

+ Wyznacz wszystkie wiersze, w których opisano jakiś gatunek sokoła.

+ Sprawdź ile samochodów ma zainstalowany autoalarm (oznaczony jako 'autoalarm')

+ Sprawdź ile samochodów ma lakier w metalicznym kolorze (oznaczony jako 'metallic')

---

# Odpowiedzi, sezon 1, odcinek 14

```{r, eval=FALSE}
# Gdzie gatunek zaczyna się na S lub s
grep("s", koty_ptaki$gatunek, ignore.case = TRUE)

# Które wiersze dotyczą sokołów
grep("Sokol", koty_ptaki$gatunek)

# liczba ofert z autoalarmem
sum(grepl(auta2012$Wyposazenie.dodatkowe.napis, pattern="autoalarm"))

# liczba ofert z lakierem metallic
sum(grepl(as.character(auta2012$Kolor), pattern="metallic"))
```

---

# Zadania, sezon 1, odcinek 15

+ Używając odpowiedniego formatowania zamień napis `01-15-2015 10:20:59` na obiekt klasy `POSIXct`.

+ Oblicz liczbę dni pomiędzy 1 września 1945 roku a 8 maja 1945.

+ Sprawdź jaki dzień tygodnia będzie za 100 dni od dziś


---

# Odpowiedzi, sezon 1, odcinek 15

```{r, eval=FALSE}
# konwersja daty
mdy_hms("01-15-2015 10:20:59")

# liczba dni różnicy
dmy("08-05-1945") - dmy("01-09-1939")

# dzień tygodnia za 100 dni od dziś
wday(today() + days(100), label = TRUE, abbr = FALSE)
```

# Zadania, sezon 1, odcinek 16

Po wczytaniu poniższej ramki danych napraw następujące błędy:

+ popraw nazwę kolumny `litąry`,
+ zamień wartości `Ą` i `Ć` na ,,bezogonkowe'',
+ zamień kolumnę `liczby` na kolumnę liczb,
+ zastąp brakujące dane w kolumnie `braku`.

```{r, eval=FALSE}
df <- data.frame(
        litąry = c("Ą","B","Ć","D"),
        liczby = c("1","2","3,0","4,0"),
        braki = c(NA,1,NA,1),
        stringsAsFactors = FALSE)
df
```

# Odpowiedzi, sezon 1, odcinek 16

```{r, eval=FALSE}
# nazwa kolumny danych
colnames(df)[1] = "litery"

# ogonki
df[df$litery == "Ą"] = "A"
df[df$litery == "Ć"] = "C"

# liczby
df$liczby <- as.numeric(gsub(",", ".", df$liczby))

# brakujące dane
df$braki[is.na(df$braki)] <- 1
```


# Zadania, sezon 1, odcinek 17

+ Ze zbioru danych `auta2012` pozostaw tylko samochody o wieku do pięciu lat (czyli o roku produkcji > 2007). Nazwij ten wynikowy zbiór danych `mlodeAuta`
+ Z przed chwilą stworzonego zbioru danych `mlodeAuta` wybierz tylko Fiaty 500. Ile jest takich aut? 
(wymiary ramki danych możesz sprawdzić funkcją **dim()**)

# Odpowiedzi, sezon 1, odcinek 17

```{r, eval=FALSE}
# tylko mlode auta
mlodeAuta <- filter(auta2012, 
                    Rok.produkcji > 2007)

# tylko mlode Fiaty
mlodeFiaty <- filter(mlodeAuta, 
                    Model == "500")
nrow(mlodeFiaty)
```

# Zadania, sezon 1, odcinek 18

* Posortuj auta wzdłuż wielkości silnika (liczby koni mechanicznych, kolumna `KM`) lub pojemności skokowej (kolumna `Pojemnosc.skokowa`). Które marki mają najwięszke silniki?
* Wybierz tylko auta marki 'Rolls-Royce' i posortuj je po cenie.

# Odpowiedzi, sezon 1, odcinek 18

```{r, eval=FALSE}
# auta z największymi silnikami (deklarowanymi)
tmp <- arrange(auta2012, -KM)
head(tmp,20)

# najtańsze Rolls-Royce
RR <- filter(auta2012, Marka == 'Rolls-Royce')
arrange(RR, Cena.w.PLN)
```


# Zadania, sezon 1, odcinek 19

* Użyj operatora `%>%` by ze zbioru danych `auta2012` wybrać tylko 10 najtańszych aut marki Rolls-Royce.
* Użyj operatora `%>%` by ze zbioru danych `auta2012` wybrać 5 Volkswagenów o największych silnikach.
 
# Odpowiedzi, sezon 1, odcinek 19

```{r, eval=FALSE}
# auta z największymi silnikami (deklarowanymi)
tmp <- arrange(auta2012, -KM)
head(tmp,20)

# najtańsze Rolls-Royce
RR <- filter(auta2012, Marka == 'Rolls-Royce')
arrange(RR, Cena.w.PLN)
```


---

# Zadania, sezon 1, odcinek 20

* Wybierz tylko samochody marki Volvo, posortuj je po pojemności skokowej, a następnie wyświetl tylko trzy kolumny: Markę, Cenę.w.PLN i Kolor.

* Wybierz tylko te kolumny, których nazwa kończy się na `a`.


# Odpowiedzi, sezon 1, odcinek 20

```{r, eval=FALSE}
# wybrać
auta2012 %>% filter(Marka == 'Volvo') %>%
  arrange(Pojemnosc.skokowa) %>%
  select(Marka, Cena.w.PLN, Kolor) 

# kolumny o nazwie zakończonej na a
auta2012 %>% select(matches("a$"))
```


---

# Zadania, sezon 1, odcinek 21

* Dla zbioru danych `koty_ptaki` dodajmy nową zmienną. Z fizyki wiemy, że pęd to prędkość razy masa. Policz maksymalne pędy dla każdego gatunku oraz uporządkuj wiersze w kolejności od tych zdolnych do uzyskiwania najwyższego pędu.
* Policz średni przebieg na rok, dzieląc przebieg przez wieka auta.
* Poza koniem mechanicznym inną ciekawą jednostką mocy jest koń parowy (jednostka HP). Jeden koń mechaniczny to 0.9863 konia parowego. Utwórz nową zmienną, która przedstawi moc aut w koniach parowych (btw: Wikipedia zna jeszcze kilka innych ciekawych jednostek mocy).

# Odpowiedzi, sezon 1, odcinek 21

```{r, eval=FALSE}
# pęd
koty_ptaki %>% 
  mutate(pęd = predkosc*waga) %>% 
  arrange(-pęd)

# przebieg
auta2012 %>% 
  mutate(Wiek = 2013 - Rok.produkcji,
         sredni_przebieg = Przebieg.w.km / Wiek)

# konie
auta2012 %>% 
  mutate(HP = 0.9863*KM)
```

# Zadania, sezon 1, odcinek 22

* Policz sumaryczny przebieg wszystkich samochodów. Następnie policz ile razy okrążono kulę ziemską uwzględniając ten sumaryczny przebieg.
* Wybierz tylko samochody marki 'Rolls-Royce' i policz ich średni przebieg oraz średnią cenę.

# Odpowiedzi, sezon 1, odcinek 22

```{r, eval=FALSE}
# przebieg
auta2012 %>%
  summarise(sumaryczny.przebieg = sum(Przebieg.w.km, na.rm = TRUE),
            okrążeń = sumaryczny.przebieg / 40075,
            średnio.okrążeń = okrążeń / n())

# Rolls-Royce
auta2012 %>%
  filter(Marka == "Rolls-Royce") %>%
  summarise( średnia.cena = mean(Cena.w.PLN),
             średni.przebieg = mean(Przebieg.w.km, na.rm=TRUE))
```

# Zadania, sezon 1, odcinek 23

* Wybierz pięcioletnie Golfy i sprawdź czy średnia cena zależy od kraju aktualnej rejestracji. W tym celu pogrupuj po zmiennej Kraj.aktualnej.rejestracji i w każdej grupie policz średnią.
* Wybierz tylko Peugeoty 206 i policz średnią cenę w zależności od roku produkcji. Posortuj te grupy po roku produkcji.

# Odpowiedzi, sezon 1, odcinek 23

```{r, eval=FALSE}
# golfy
auta2012 %>%
  filter(Model == "Golf", Rok.produkcji == 2007) %>%
  group_by(Kraj.aktualnej.rejestracji) %>%
  summarise(sredniaCena = mean(Cena.w.PLN)) %>%
  arrange(sredniaCena)

# peugeoty
auta2012 %>%
  filter(Marka == "Peugeot", Model == "206") %>%
  group_by(Rok.produkcji) %>%
  summarise( średnia.cena = mean(Cena.w.PLN))
```


# Zadania, sezon 1, odcinek 24

* W bazie danych Eurostatu o nazwie `prc_ppp_ind` zbierane są informacje o średniej sile nabywczej.
Odczytaj te dane funkcją `getEurostatRCV()` a następnie zamień z postaci wąskiej do szerokiej.
* Ze zbioru danych `kidney` wybierz tylko kolumny MDRD12, MDRD24, MDRD36, MDRD60 a następnie zamień je z postaci szerokiej do wąskiej.
* W zbiorze danych `kidney` niezgodności w antygenach AB i DR są opsisane przez kolumny `discrepancy.AB` i `discrepancy.DR`. Zamień je w jedną kolumnę o nazwie `discrepancy` gdzie obie niezgodności są sklejone i separowane znakiem `_`.

# Odpowiedzi, sezon 1, odcinek 24

```{r, eval=FALSE}
# siła nabywcza
prc_ppp_ind <- getEurostatRCV("prc_ppp_ind")
spread(prc_ppp_ind, time, value)

# nerki
kidney$id <- rownames(kidney)
kidney %>% 
  dplyr::select(id, MDRD12:MDRD60) %>%
  gather(MDRD, time, MDRD12:MDRD60) %>%
  head()

# niezgodnosci
kidney %>%
  dplyr::select(therapy, discrepancy.AB, discrepancy.DR) %>%
  unite(discrepancy, discrepancy.AB, discrepancy.DR, sep="_") %>%
  head()

```


