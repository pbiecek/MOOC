---
title: "Zadania i odpowiedzi"
author: "pogRomcy danych"
date: "sezon 0 / odcinek 0 <br><br> Wszelkie prawa zastrzeżone.<br> Wykorzystanie możliwe wyłącznie za zgodą autora.  <br><br><br><br>Naciśnij `A` by zamienić slajdy na ciągły tekst. <br> Naciśnij `T` by wyświetlić spis treści."
output:
  slidy_presentation:
    includes:
      in_header: ../tracking.html
    highlight: default
    css: ../style.css
    font_adjustment: 0
    footer: "pogRomcy danych / wizualizacja / zadania i odpowiedzi"
---

# Zadanie, sezon 2, odcinek 2

+ Przedstaw graficznie za pomocą wykresu punktowego zależność pomiędzy żywotnością (kolumna `zywotnosc`) a wagą zwierzęcia (kolumna `waga`).

+ Zaznacz kolorem lub kształtem punktu informację czy przedstawiany jest ptak czy kot. Czy są różnice pomiędzy żywotnością a wagą dla kotów i ptaków?

+  Użyj etykiet by odczytać który ptak i który kot żyją najdłużej

+ Używając geometrii wstęga (`geom_ribbon`) przedstaw kurs minimalny i maksymalny każdego dnia na podstawie danych ze zbioru `WIG`.


# Odpowiedź, sezon 2, odcinek 2

```{r, message=FALSE, eval=FALSE}
library(PogromcyDanych)
library(ggplot2)

# Przedstaw graficznie za pomocą wykresu punktowego zależność pomiędzy 
# żywotnością (kolumna `zywotnosc`) a wagą zwierzęcia (kolumna `waga`).
ggplot(koty_ptaki, aes(x = waga, y=zywotnosc)) + 
  geom_point()

# Zaznacz kolorem lub kształtem punktu informację czy przedstawiany 
# jest ptak czy kot. Czy są różnice pomiędzy żywotnością a wagą dla 
# kotów i ptaków?
ggplot(koty_ptaki, aes(x = waga, y=zywotnosc, color=druzyna, shape=druzyna)) + 
  geom_point()

# Użyj etykiet by odczytać który ptak i który kot żyją najdłużej
ggplot(koty_ptaki, aes(x = waga, y=zywotnosc, color=druzyna, shape=druzyna, label=gatunek)) + 
  geom_text()

# Używając geometrii wstęga (`geom_ribbon`) przedstaw kurs minimalny 
# i maksymalny każdego dnia na podstawie danych ze zbioru `WIG`.
ggplot(WIG, aes(x = Data, ymin=Kurs.minimalny, ymax=Kurs.maksymalny)) + 
  geom_ribbon()

```

---

# Zadanie, sezon 2, odcinek 3

+ Wybierz samochody marki Volkswagen model Passat a następnie narysuj jak średnia cena zależy od roku produkcji za pomocą geometrii `geom_smooth()`.

+ Wybierz samochody marki Volkswagen, narysuj jak średnia cena zależy od roku produkcji, różnymi kolorami przedstaw różne modele Volkswagena.

+ Wybierz pięcioletnie auta marki Volkswagen i za pomocą wykresu ramka - wąsy przedstaw jak cena auta zależy od modelu.

+ Dla wybranych pięcioletnich aut marki Volkswagen przedstaw w podziale na modele jaka część aut ma silnik diesla.

# Odpowiedź, sezon 2, odcinek 3

```{r, message=FALSE, eval=FALSE}
# Wybierz samochody marki Volkswagen model Passat a następnie narysuj 
# jak średnia cena zależy od roku produkcji za pomocą geometrii `geom_smooth()`.

passat <- auta2012 %>%
              filter(Marka == 'Volkswagen', Model == 'Passat', Rok.produkcji > 1990) %>%
              select(Marka, Model, Rok.produkcji, Cena.w.PLN, Rodzaj.paliwa)

ggplot(passat, aes(x=Rok.produkcji, y=Cena.w.PLN)) + 
  geom_smooth()

# Wybierz samochody marki Volkswagen, narysuj jak średnia cena zależy 
# od przebiegu, różnymi kolorami przedstaw różne modele Volkswagena.

volkswagen <- auta2012 %>%
              filter(Marka == 'Volkswagen', Model %in% c('Passat', 'Golf', 'Polo', 'Sharan'), Rok.produkcji > 1990, Rok.produkcji < 2012) %>%
              select(Marka, Model, Rok.produkcji, Cena.w.PLN, Rodzaj.paliwa)

ggplot(volkswagen, aes(x=Rok.produkcji, y=Cena.w.PLN, color=Model)) + 
  geom_smooth()

# Wybierz pięcioletnie auta marki Volkswagen i za pomocą wykresu 
# ramka - wąsy przedstaw jak cena auta zależy od modelu.

volkswagen <- auta2012 %>%
              filter(Marka == 'Volkswagen', Rok.produkcji == 2007, Model %in% c('Passat', 'Golf', 'Polo', 'Sharan')) %>%
              select(Marka, Model, Rok.produkcji, Cena.w.PLN, Rodzaj.paliwa)

ggplot(volkswagen, aes(x=Model, y=Cena.w.PLN)) + 
  geom_boxplot()

# Dla wybranych pięcioletnich aut marki Volkswagen przedstaw w podziale 
# na modele jaka część aut ma silnik diesla.

ggplot(volkswagen, aes(x=Model, fill=Rodzaj.paliwa)) + 
  geom_bar(position = 'fill')

```

# Zadanie, sezon 2, odcinek 4

+ Podobnie jak w poprzednim odcinku, wybierz samochody marki Volkswagen model Passat a następnie narysuj jak średnia cena zależy od roku produkcji za pomocą geometrii `geom_smooth()`. Następnie zobacz jak ten wykres będzie wyglądał z motywami `theme_bw()`, `theme_excel()` i `theme_economist()`.

+ Zmień poniższy wykres, zamieniając skalę kolorów na od zielonego do czerwonego, kropki zamień na kwadraty a do wykresu dodaj tytuł (i odpowiednie etykiety osi).

```{r, eval=FALSE}
ggplot(koty_ptaki, aes(x=waga, y=predkosc, size=zywotnosc, color=zywotnosc)) +
  geom_point() 
```

# Odpowiedzi, sezon 2, odcinek 4

```{r, message=FALSE, eval=FALSE}
# Podobnie jak w poprzednim odcinku, wybierz samochody marki Volkswagen model 
# Passat a następnie narysuj jak średnia cena zależy od roku produkcji za pomocą
# geometrii `geom_smooth()`. Następnie zobacz jak ten wykres będzie wyglądał 
# z motywami `theme_bw()`, `theme_excel()` i `theme_economist()`.

passat <- auta2012 %>%
              filter(Marka == 'Volkswagen', Model == 'Passat', Rok.produkcji > 1990) %>%
              select(Marka, Model, Rok.produkcji, Cena.w.PLN, Rodzaj.paliwa)

pl <- ggplot(passat, aes(x=Rok.produkcji, y=Cena.w.PLN)) + 
  geom_smooth()

library(ggthemes)
pl + theme_bw() + ggtitle("theme_bw")
pl + theme_excel() + ggtitle("theme_excel")
pl + theme_minimal() + ggtitle("theme_minimal")
pl + theme_economist() + ggtitle("theme_economist")


# Zmień poniższy wykres, zamieniając skalę kolorów na od zielonego do czerwonego,
# kropki zamień na kwadraty a do wykresu dodaj tytuł (i odpowiednie etykiety osi).
# ggplot(koty_ptaki, aes(x=waga, y=predkosc, size=zywotnosc, color=zywotnosc)) +
#    geom_point() 

ggplot(koty_ptaki, aes(x=waga, y=predkosc, size=zywotnosc, color=zywotnosc)) +
    geom_point(shape=18) +  
  scale_color_gradient(high = "green3", low = "red3") +
  ggtitle("Zielone latające kwadraty") + xlab("Waga [kg]") + ylab("Prędkość [km/h]")
```

# Zadanie, sezon 2, odcinek 12

- Wybierz serial *Friday Night Lights* zobacz jak wygląda popularność tego serialu. Czy jest bardziej popularny niż *Breaking Bad*?

- Zobacz jak popularność tego serialu zmieniała się w czasie. Czy zaobserwowałeś coś interesującego?

- Zamiast prezentować informacje o ocenach odcinków przedstaw informacje o liczbie oddanych głosów (popularności) odcinków. Czy te same statystyki nadają się równie dobrze do prezentacji informacji o ocenie i o liczbie głosów?

# Odpowiedź, sezon 2, odcinek 12

```{r, message=FALSE, eval=FALSE}
# Wybierz serial *Friday Night Lights* zobacz jak wygląda popularność tego serialu. 
# Czy jest bardziej popularny niż *Breaking Bad*?

FNL <- filter(serialeIMDB, serial == "Friday Night Lights")
summary(FNL$glosow)
BB <- filter(serialeIMDB, serial == "Breaking Bad")
summary(BB$glosow)

# Zobacz jak popularność tego serialu zmieniała się w czasie. 
# Czy zaobserwowałeś coś interesującego?

plot(FNL$glosow)
```

# Zadanie, sezon 2, odcinek 13

* Znajdź serial o najsilniej rosnącym trendzie dotyczącym ocen (ponieważ oceny są ograniczone z góry przez 10 to może nie być serial o najwyższej średniej ocenie)

* Znajdź serial o najsilniejszym trendzie spadkowym

# Odpowiedź, sezon 2, odcinek 13

```{r, message=FALSE, eval=FALSE}
# Znajdź serial o najsilniej rosnącym trendzie dotyczącym ocen 
# (ponieważ oceny są ograniczone z góry przez 10 to może nie być serial o najwyższej średniej ocenie)

# Znajdź serial o najsilniejszym trendzie spadkowym

nazwy_seriali <- levels(serialeIMDB$serial)
wspolczynnikTrendu <- c()

for (ser in nazwy_seriali) {
  jedenSerial <- serialeIMDB %>%
    filter(serial == ser) %>% 
    select(id, ocena)
  wspolczynnikTrendu[ser] <- lm(ocena~id, jedenSerial)$coef[2]
}
# na początku najsilniejsze spadki, na koniec wzrosty
sort(wspolczynnikTrendu)

```


# Zadanie, sezon 2, odcinek 14

* Znajdź serial o istotnym ujemnem trendem, to znaczy takim, którego oceny maleją.

* Znajdź serial (inny niż _Breaking Bad_) o istotnie dodatnim trendzie. 

* [Trudne] Policz dla ilu serialu ich oceny rosną a dla ilu maleją i te wzrosty lub spadki są istotnie większe niż wynikające z przypadku.

# Odpowiedź, sezon 2, odcinek 14

```{r, message=FALSE, eval=FALSE}
# Znajdź serial o istotnym ujemnem trendzie, to znaczy takim, którego oceny maleją.

# Znajdź serial (inny niż _Breaking Bad_) o istotnie dodatnim trendzie. 

# Rozwiązanie: Jak w zadaniu 13, plus testowanie istotności dla skrajnych wartości
# uwaga, może się długo liczyć!!!

```

# Zadania, sezon 2, odcinek 15

+ Dla każdego wzrostu rodzica ze zbioru danych `galton` wyznacz o ile średnio niższe są dzieci od rodziców.

+ Mając wyznaczone parametry _b0_ i _b1_ policz oceny średniego wzrostu dziecka dla każdego średniego wzrostu rodzica.

+ Wyznacz różnice pomiędzy ocenami z modelu liniowego a średnimi liczonymi osobno dla każdej grupy rodziców.

+  W pakiecie `PogromcyDanych` udostępniony jest również zbiór danych `pearson` zebrany przez Pearsona. W tym zbiorze danych zebrane są wzrosty ojców i synów.

Dla tego zbioru danych wyznacz model regresji liniowej oraz narysuj zbiór danych z zaznaczoną krzywą regresji liniowej.

Czy parametry regresji liniowej w zbiorze pearsona (z wysokością ojca) różnią się od parametrów ze zbioru galtona (ze średnią wysokością rodziców)?

# Odpowiedzi, sezon 2, odcinek 15

```{r, warning=FALSE, width=8, height=8, eval=FALSE}
# Dla każdego wzrostu rodzica ze zbioru danych `galton` wyznacz 
# o ile średnio niższe są dzieci od rodziców
# wykorzystując funkcje z pakietu dplyr
srednie %>%
  mutate(roznica = srednia - rodzic)

# Mając wyznaczone parametry _b0_ i _b1_ policz oceny średniego wzrostu 
# dziecka dla każdego średniego wzrostu rodzica
wspolczynniki = coef(lm(syn~rodzic, data=galton)
wspolczynniki

# Wyznacz różnice pomiędzy ocenami z modelu liniowego 
# a średnimi liczonymi osobno dla każdej grupy rodziców
srednie %>%
  mutate(m.liniowy = wspolczynniki[1] + rodzic*wspolczynniki[2],
         roznica = srednia - m.liniowy)
```


 